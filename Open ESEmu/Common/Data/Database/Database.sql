DROP DATABASE IF EXISTS OpenESEmu;
CREATE DATABASE OpenESEmu;
USE OpenESEmu;

DROP TABLE IF EXISTS OpenESEmu.Accounts;
CREATE TABLE `Accounts` (
  `ID` int(8) unsigned NOT NULL AUTO_INCREMENT,
  `EMail` varchar(30) NOT NULL,
  `Password` varchar(30) NOT NULL,
  `JoinDate` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `Status` enum('STATUS_NOT_ACTIVE', 'STATUS_ACTIVE', 'STATUS_BANNED') NOT NULL DEFAULT 'STATUS_NOT_ACTIVE',
  `AuthLevel` enum('AUTH_PLAYER', 'AUTH_MOD', 'AUTH_ADM', 'AUTH_DEV') DEFAULT 'AUTH_PLAYER',
  `LastLogin` TIMESTAMP NOT NULL DEFAULT '2000-12-31 01:00:00',
  `SecurityPIN` varchar(4) NOT NULL DEFAULT '0000',
  `BannedUntil` TIMESTAMP NOT NULL DEFAULT '2020-07-15 16:20:00',
  PRIMARY KEY (`ID`)
) ENGINE=MyISAM AUTO_INCREMENT=10 DEFAULT CHARSET=latin1;

INSERT INTO OpenESEmu.Accounts (`ID`, `EMail`, `Password`, `Status`, `AuthLevel`) VALUES ('1', 'd3v1l401@d3vsite.org', 'test', 'STATUS_ACTIVE', 'AUTH_DEV');

DROP TABLE IF EXISTS OpenESEmu.Characters;
CREATE TABLE OpenESEmu.Characters
(
	ID INT(8) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
	OwnerID int(8) unsigned NOT NULL,
	CreateDate TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
	LastUsed TIMESTAMP NOT NULL DEFAULT '2020-07-15 16:20:00',
	Nickname VARCHAR(40) NOT NULL,
    
    FOREIGN KEY (OwnerID) REFERENCES OpenESEmu.Accounts(ID) ON UPDATE CASCADE ON DELETE RESTRICT
) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=latin1;

DROP TABLE IF EXISTS OpenESEmu.APIAuths;
CREATE TABLE OpenESEmu.APIAuths (
  ID int(11) NOT NULL,
  User varchar(255) NOT NULL,
  Password varchar(255) DEFAULT NULL,
  Token varchar(4096) DEFAULT NULL,
  Type enum('SEED_TOKEN','BASIC_AUTH') NOT NULL DEFAULT 'BASIC_AUTH',
  PRIMARY KEY (ID, User)
) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=latin1;